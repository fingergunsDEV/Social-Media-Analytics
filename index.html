<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Social Media Dashboard</title>
  <!-- Tailwind CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
  <!-- Google APIs Client Library -->
  <script src="https://apis.google.com/js/api.js"></script>
  <!-- Font Awesome CDN (Optional for Icons) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <!-- Lodash CDN (Optional for Utility Functions) -->
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
  <style>
    .tab-button.active {
      @apply bg-blue-500 text-white transform scale-105 transition-all duration-200;
    }
    .tab-button {
      @apply transition-all duration-200;
    }
    .tab-button:hover {
      @apply bg-gray-200 transform scale-103;
    }
    .card {
      @apply transition-all duration-300;
    }
    .card:hover {
      @apply transform -translate-y-1 shadow-xl;
    }
    canvas {
      max-height: 400px;
    }
  </style>
</head>
<body class="bg-gray-50 font-sans antialiased">
  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-white shadow-xl p-6 space-y-4">
      <h2 class="text-2xl font-bold text-blue-600 mb-8 flex items-center">
        <i class="fas fa-chart-line mr-2"></i> Analytics
      </h2>
      <button class="tab-button w-full text-left px-4 py-3 rounded-lg font-medium text-gray-700 flex items-center" data-tab="dashboard">
        <i class="fas fa-tachometer-alt mr-2"></i> Dashboard
      </button>
      <button class="tab-button w-full text-left px-4 py-3 rounded-lg font-medium text-gray-700 flex items-center" data-tab="data">
        <i class="fas fa-table mr-2"></i> Data
      </button>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8">
      <!-- Dashboard Tab -->
      <div id="dashboard" class="tab-content">
        <h1 class="text-3xl font-bold mb-8 text-gray-800 text-center">Social Media Analytics</h1>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Facebook Card -->
          <div class="card bg-white shadow-lg rounded-2xl p-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
              <i class="fab fa-facebook-f mr-2 text-blue-600"></i> Facebook
            </h2>
            <ul class="space-y-2 text-gray-600">
              <li><strong>Reach:</strong> <span id="facebook-reach">0</span></li>
              <li><strong>Engagement:</strong> <span id="facebook-engagement">0</span></li>
              <li><strong>Likes:</strong> <span id="facebook-likes">0</span></li>
              <li><strong>Follows:</strong> <span id="facebook-follows">0</span></li>
              <li><strong>Shares:</strong> <span id="facebook-shares">0</span></li>
              <li><strong>Impressions:</strong> <span id="facebook-impressions">0</span></li>
              <li><strong>Clicks:</strong> <span id="facebook-clicks">0</span></li>
            </ul>
          </div>
          <!-- LinkedIn Card -->
          <div class="card bg-white shadow-lg rounded-2xl p-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
              <i class="fab fa-linkedin-in mr-2 text-blue-700"></i> LinkedIn
            </h2>
            <ul class="space-y-2 text-gray-600">
              <li><strong>Reach:</strong> <span id="linkedin-reach">0</span></li>
              <li><strong>Engagement:</strong> <span id="linkedin-engagement">0</span></li>
              <li><strong>Likes:</strong> <span id="linkedin-likes">0</span></li>
              <li><strong>Follows:</strong> <span id="linkedin-follows">0</span></li>
              <li><strong>Shares:</strong> <span id="linkedin-shares">0</span></li>
              <li><strong>Impressions:</strong> <span id="linkedin-impressions">0</span></li>
              <li><strong>Clicks:</strong> <span id="linkedin-clicks">0</span></li>
            </ul>
          </div>
        </div>

        <!-- Chart Section -->
        <div class="mt-12 bg-white shadow-lg rounded-2xl p-6">
          <h2 class="text-2xl font-bold mb-6 text-gray-800 text-center">Engagement Overview</h2>
          <canvas id="engagementChart"></canvas>
        </div>
      </div>

      <!-- Data Tab -->
      <div id="data" class="tab-content hidden">
        <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
          <i class="fas fa-database mr-2"></i> Data Housing
        </h2>
        <div class="overflow-x-auto bg-white shadow-lg rounded-2xl">
          <table class="min-w-full table-auto">
            <thead>
              <tr class="bg-blue-50 text-left text-gray-700">
                <th class="px-6 py-4 font-semibold">Platform</th>
                <th class="px-6 py-4 font-semibold">Reach</th>
                <th class="px-6 py-4 font-semibold">Engagement</th>
                <th class="px-6 py-4 font-semibold">Likes</th>
                <th class="px-6 py-4 font-semibold">Follows</th>
                <th class="px-6 py-4 font-semibold">Shares</th>
                <th class="px-6 py-4 font-semibold">Impressions</th>
                <th class="px-6 py-4 font-semibold">Clicks</th>
              </tr>
            </thead>
            <tbody id="sheetData"></tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <script>
    // Google Sheets API Configuration
    const API_KEY = 'YOUR_API_KEY';
    const CLIENT_ID = 'YOUR_CLIENT_ID';
    const SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID';
    const RANGE = 'Sheet1!A2:H';
    const DISCOVERY_DOCS = ['https://sheets.googleapis.com/$discovery/rest?version=v4'];
    const SCOPES = 'https://www.googleapis.com/auth/spreadsheets.readonly';

    // Tab Switching
    document.querySelectorAll('.tab-button').forEach(button => {
      button.addEventListener('click', () => {
        document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
        document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
        document.getElementById(button.dataset.tab).classList.remove('hidden');
        button.classList.add('active');
      });
    });

    // Initialize Google API Client
    function initClient() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: DISCOVERY_DOCS,
        scope: SCOPES,
      }).then(() => {
        gapi.auth2.getAuthInstance().signIn().then(() => {
          loadSheetData();
        });
      });
    }

    // Load and Display Sheet Data
    function loadSheetData() {
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: SPREADSHEET_ID,
        range: RANGE,
      }).then((response) => {
        const rows = response.result.values || [];
        const tbody = document.getElementById('sheetData');
        tbody.innerHTML = '';

        const platforms = {
          'Facebook': {
            reach: 'facebook-reach',
            engagement: 'facebook-engagement',
            likes: 'facebook-likes',
            follows: 'facebook-follows',
            shares: 'facebook-shares',
            impressions: 'facebook-impressions',
            clicks: 'facebook-clicks'
          },
          'LinkedIn': {
            reach: 'linkedin-reach',
            engagement: 'linkedin-engagement',
            likes: 'linkedin-likes',
            follows: 'linkedin-follows',
            shares: 'linkedin-shares',
            impressions: 'linkedin-impressions',
            clicks: 'linkedin-clicks'
          }
        };

        const chartData = {
          labels: [],
          engagement: []
        };

        rows.forEach(row => {
          const [platform, reach, engagement, likes, follows, shares, impressions, clicks] = row;
          const tr = document.createElement('tr');
          tr.className = 'hover:bg-gray-50';
          tr.innerHTML = `
            <td class="px-6 py-4 font-semibold text-gray-700">${platform}</td>
            <td class="px-6 py-4 text-gray-600">${reach}</td>
            <td class="px-6 py-4 text-gray-600">${engagement}</td>
            <td class="px-6 py-4 text-gray-600">${likes}</td>
            <td class="px-6 py-4 text-gray-600">${follows}</td>
            <td class="px-6 py-4 text-gray-600">${shares}</td>
            <td class="px-6 py-4 text-gray-600">${impressions}</td>
            <td class="px-6 py-4 text-gray-600">${clicks}</td>
          `;
          tbody.appendChild(tr);

          // Update Dashboard Cards
          if (platforms[platform]) {
            document.getElementById(platforms[platform].reach).textContent = reach;
            document.getElementById(platforms[platform].engagement).textContent = engagement;
            document.getElementById(platforms[platform].likes).textContent = likes;
            document.getElementById(platforms[platform].follows).textContent = follows;
            document.getElementById(platforms[platform].shares).textContent = shares;
            document.getElementById(platforms[platform].impressions).textContent = impressions;
            document.getElementById(platforms[platform].clicks).textContent = clicks;
          }

          // Collect Chart Data
          chartData.labels.push(platform);
          chartData.engagement.push(parseInt(engagement) || 0);
        });

        // Update Chart
        engagementChart.data.labels = chartData.labels;
        engagementChart.data.datasets[0].data = chartData.engagement;
        engagementChart.update();
      });
    }

    // Load Google API
    gapi.load('client:auth2', initClient);

    // Chart.js Configuration
    const ctx = document.getElementById('engagementChart').getContext('2d');
    const engagementChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: [],
        datasets: [{
          label: 'Engagement',
          data: [],
          backgroundColor: 'rgba(59, 130, 246, 0.6)',
          borderColor: 'rgba(59, 130, 246, 1)',
          borderWidth: 1,
          borderRadius: 8
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'top',
            labels: {
              font: {
                size: 14,
                weight: 'bold'
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            },
            ticks: {
              font: {
                size: 12
              }
            }
          },
          x: {
            grid: {
              display: false
            },
            ticks: {
              font: {
                size: 12
              }
            }
          }
        }
      }
    });

    // Optional: Debounce Sheet Data Loading with Lodash
    const debouncedLoadSheetData = _.debounce(loadSheetData, 1000);
    document.addEventListener('click', () => {
      if (document.getElementById('data').classList.contains('hidden')) return;
      debouncedLoadSheetData();
    });
  </script>
</body>
</html>
